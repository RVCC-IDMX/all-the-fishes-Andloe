<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All The Fishes</title>
    <script src="https://pixijs.download/release/pixi.js"></script>
</head>
<body>
    <script>

        //The App
        var app = new PIXI.Application({
            width:640,
            height:480,
            backgroundColor: 0x3480eb
        });

        //Add view to the document
        document.body.appendChild(app.view);

        //My first sprite
        let fish1 = PIXI.Sprite.from("img/greenfish.png");
            fish1.width = 200;
            fish1.height = 200;
            fish1.y = 0;
            fish1.x = 50;
            fish1.anchor.set(.5);

        //Add it to the stage
        app.stage.addChild(fish1);

         //My second sprite
        let fish2 = PIXI.Sprite.from("img/clownfish.png");
            fish2.y = 0;
            fish2.x = 450;
            fish2.anchor.set(.5);
            fish2.scale.set(.10);

        //Add it to the stage
        app.stage.addChild(fish2);
        
        //My third sprite 
        let fish3 = PIXI.Sprite.from("img/snaperfish.png");
            fish3.y = 0;
            fish3.x = 280;
            fish3.anchor.set(.5);
            fish3.scale.set(.20);
            fish3.interactive = true;
            fish3.buttonMode = true;

        //Add it to the stage
        app.stage.addChild(fish3);

        //Adding background elements
        let algae1 = PIXI.Sprite.from("img/algae1.png");
            algae1.y = 350;
            algae1.x = 600;
            algae1.anchor.set(.5);
            algae1.scale.set(.100);

        //Add it to the stage
        app.stage.addChild(algae1);

        let blueAlgae = PIXI.Sprite.from("img/blue-algae.png");
            blueAlgae.y = 350;
            blueAlgae.x = 320;
            blueAlgae.anchor.set(.5);
            blueAlgae.scale.set(.5);

        //Add it to the stage
        app.stage.addChild(blueAlgae);

        let coral = PIXI.Sprite.from("img/coral.png");
            coral.y = 300;
            coral.x = 100;
            coral.anchor.set(.5);
            coral.scale.set(.15);

        //Add it to the stage
        app.stage.addChild(coral);

        let seaPlants = PIXI.Sprite.from("img/sea-plants.png");
            seaPlants.y = 350;
            seaPlants.x = 280;
            seaPlants.anchor.set(.5);
            seaPlants.scale.set(.5);

        //Add it to the stage
        app.stage.addChild(seaPlants);


    

        //My container 
        var my_container = new PIXI.Container();
            my_container.addChild(fish1);
            my_container.addChild(fish2);
            my_container.addChild(fish3);
            my_container.x = 100;
            my_container.y = 240;

        app.stage.addChild(my_container);

        //Animation loop
        function animationLoop() {

            let time = Date.now();

            let wobble1 = Math.sin(time/1000)*20;
            let wobble2 = Math.sin(time/250)*20;
            let wobble3 = Math.sin(time/500)*20;

            fish1.y = wobble1;
            fish2.y = wobble2;
            fish3.y = wobble3;

            setTimeout(animationLoop, 1000/30);
        }
        animationLoop();

        // Adding Buttons
        
        function makeButton() {

            let ourButton = new PIXI.Container();
                ourButton.interactive = true;

            let buttonBody = new PIXI.Graphics();
                buttonBody.beginFill(0xEEEEEE);
                buttonBody.drawRect(0, 0, 200, 100);
                ourButton.addChild(buttonBody);

                ourButton.body = buttonBody;

            let buttonText = new PIXI.Text('Change Color');
                buttonText.anchor.set(.5,.5);
                buttonText.x = 100;
                buttonText.y = 50;
                ourButton.addChild(buttonText);

                ourButton.text = buttonText;

            //Event Listeners
            //Click listener
            ourButton.on("click",function (e) {
            //alert("clicked!");
                console.log(e);
                fish1.tint = Math.random() * 0xFFFFFF;
            });


            //Hover listeners
            ourButton.on("pointerover",function (e) {
                ourButton.alpha = 0.7;
            });
            ourButton.on("pointerout",function (e) {
                ourButton.alpha = 1.0;
            });
            


        //Draggable Fish

        //Event Listeners
        //Click listener
        fish3.on("click",function (e) {
            //alert("clicked!");
            fish3.log(e);
        });
        //Hover listeners
        fish3.on("pointerover",function (e) {
            fish3.alpha = 0.7;
        });
        fish3.on("pointerout",function (e) {
            fish3.alpha = 1.0;
        });

        //Dragable event listeners
        fish3.dragging = false;
            fish3.on("pointerdown",function (e) {
                fish3.dragging = true;
        });
            fish3.on("pointermove",function (e) {
            if(fish3.dragging) {
                console.log(e);
                fish3.x = e.data.global.x - fish3.width/2;
                fish3.y = e.data.global.y - fish3.height/2;
            }
        });
        fish3.on("pointerup",function (e) {
            fish3.dragging = false;
        });
          

        return ourButton;

}

    let ourButton = makeButton();


            //Sliders are buttons that can be dragged along a track.
            //The most common are straight lines, or circles.

            function makeSlider() {

            let ourButton = new PIXI.Container();
                ourButton.interactive = true;

                ourButton.value = 0;

            //The track
            let theTrack = new PIXI.Graphics();
                theTrack.beginFill(0xCCCCCC);
                theTrack.drawRect(0, -10, 300, 20);

                ourButton.addChild(theTrack);

            //The slide
            let theSlide = new PIXI.Graphics();
                theSlide.interactive = true;
                theSlide.beginFill(0xEEEEEE);
                theSlide.drawRect(-25, -25, 50, 50);

                ourButton.addChild(theSlide);

            //Add event listeners
            //Draggable event listeners
            theSlide.dragging = false;
            theSlide.on("pointerdown",function (e) {
                theSlide.dragging = true;
            });
            theSlide.on("pointermove",function (e) {
                if(theSlide.dragging) {

                    let newX = e.data.global.x - ourButton.getGlobalPosition().x;
                    let newY = e.data.global.y - ourButton.getGlobalPosition().y;

        /*
        console.log(
                Math.round(e.data.global.x),
                Math.round(e.data.global.y),
                Math.round(newX), 
                Math.round(newY),
                ourButton.getGlobalPosition());*/

        if (newX > theTrack.width) newX = theTrack.width;
        if (newX < 0 ) newX = 0;

        ourButton.value = newX/theTrack.width;

        theSlide.x = newX;

        console.log(ourButton.value);
    }
});
theSlide.on("pointerup",function (e) {
    theSlide.dragging = false;
});
theSlide.on("pointerupoutside",function (e) {
    theSlide.dragging = false;
});

    return ourButton;

}

let ourSlider = makeSlider();
    ourSlider.y = 50;
    ourSlider.x = 280;
    app.stage.addChild(ourSlider);













//Build a button that changes one of the fish's colors randomly.

//Make one of your fish draggable

//Build a slider or dial that changes the size or rotation of one of your fish.

app.stage.addChild(ourButton);

    </script>

</body>
</html>